<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>StFX Parking - Login</title>
  <style>
    :root{
      --bg:#0b1220;
      --card:rgba(255,255,255,0.06);
      --card-border:rgba(255,255,255,0.12);
      --text:#e7eefc;
      --muted:rgba(231,238,252,0.7);
      --primary:#6ea8ff;
      --primary-2:#8b5cf6;
      --danger:#ff5a7a;
      --success:#35d39d;
      --shadow:0 20px 60px rgba(0,0,0,0.45);
      --radius:18px;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background: radial-gradient(1200px 600px at 20% 10%, rgba(139,92,246,0.25), transparent 60%),
                  radial-gradient(900px 500px at 80% 20%, rgba(110,168,255,0.22), transparent 55%),
                  radial-gradient(800px 500px at 50% 90%, rgba(53,211,157,0.15), transparent 60%),
                  var(--bg);
      color:var(--text);
      min-height:100vh;
      display:grid;
      place-items:center;
      padding:24px;
    }
    .wrap{width:min(460px,100%);}
    .brand{
      display:flex; align-items:center; gap:10px;
      margin-bottom:14px; user-select:none;
    }
    .logo{
      width:44px; height:44px; border-radius:14px;
      background:linear-gradient(135deg,var(--primary),var(--primary-2));
      box-shadow:0 12px 35px rgba(110,168,255,0.35);
      display:grid; place-items:center;
      font-weight:800; letter-spacing:.5px;
    }
    .brand h1{font-size:18px; margin:0; line-height:1.1;}
    .brand p{margin:2px 0 0; font-size:12px; color:var(--muted);}
    .card{
      background:var(--card);
      border:1px solid var(--card-border);
      border-radius:var(--radius);
      padding:22px;
      box-shadow:var(--shadow);
      backdrop-filter:blur(14px);
      -webkit-backdrop-filter:blur(14px);
    }
    .top-row{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; margin-bottom:10px;
    }
    .pill{
      display:inline-flex; gap:6px; padding:6px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.14);
      background:rgba(255,255,255,0.05);
    }
    .pill button{
      border:none; cursor:pointer;
      padding:8px 12px; border-radius:999px;
      background:transparent;
      color:rgba(231,238,252,0.75);
      font-weight:700; font-size:12px;
      transition:background 140ms ease, color 140ms ease;
    }
    .pill button.active{
      background:rgba(255,255,255,0.10);
      color:var(--text);
    }
    h2{margin:0 0 6px; font-size:20px;}
    .subtitle{margin:0 0 16px; color:var(--muted); font-size:13px; line-height:1.4;}
    form{display:grid; gap:12px;}
    .field{display:grid; gap:6px;}
    label{font-size:12px; color:var(--muted);}
    .input{
      display:flex; align-items:center;
      background:rgba(255,255,255,0.06);
      border:1px solid rgba(255,255,255,0.12);
      border-radius:14px;
      padding:10px 12px;
      transition:border 150ms ease, transform 150ms ease;
    }
    .input:focus-within{border-color:rgba(110,168,255,0.55); transform:translateY(-1px);}
    input{
      width:100%; background:transparent; border:none; outline:none;
      color:var(--text); font-size:14px;
    }
    input::placeholder{color:rgba(231,238,252,0.45);}
    .icon-btn{
      border:none; background:transparent;
      color:rgba(231,238,252,0.75);
      cursor:pointer; padding:6px;
      border-radius:10px; transition:background 120ms ease;
      line-height:0;
    }
    .icon-btn:hover{background:rgba(255,255,255,0.07);}
    .row{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px; margin-top:4px;
    }
    .check{
      display:flex; align-items:center; gap:8px;
      color:var(--muted); font-size:12px; user-select:none;
    }
    .check input{width:14px; height:14px; accent-color:var(--primary);}
    .link{color:rgba(110,168,255,0.9); text-decoration:none; font-size:12px;}
    .link:hover{text-decoration:underline;}
    .btn{
      margin-top:6px; width:100%;
      border:none; cursor:pointer;
      padding:12px 14px;
      border-radius:14px;
      color:#061022; font-weight:800; font-size:14px;
      background:linear-gradient(135deg,var(--primary),var(--primary-2));
      box-shadow:0 16px 40px rgba(110,168,255,0.25);
      transition:transform 140ms ease, filter 140ms ease;
    }
    .btn:hover{transform:translateY(-1px); filter:brightness(1.05);}
    .message{
      margin-top:12px;
      font-size:12px;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid transparent;
      display:none;
    }
    .message.error{
      display:block;
      border-color:rgba(255,90,122,0.35);
      background:rgba(255,90,122,0.12);
      color:rgba(255,215,225,0.98);
    }
    .message.success{
      display:block;
      border-color:rgba(53,211,157,0.35);
      background:rgba(53,211,157,0.12);
      color:rgba(201,255,239,0.98);
    }
    .footer{
      margin-top:14px;
      text-align:center;
      color:rgba(231,238,252,0.55);
      font-size:12px;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="brand">
      <div class="logo">XP</div>
      <div>
        <h1>StFX Parking</h1>
        <p>Student parking portal</p>
      </div>
    </div>

    <div class="card" id="authCard">
      <div class="top-row">
        <div>
          <h2 id="title">Welcome back</h2>
          <p class="subtitle" id="subtitle">Login to continue.</p>
        </div>
        <div class="pill">
          <button id="tabLogin" class="active" type="button">Login</button>
          <button id="tabSignup" type="button">Signup</button>
        </div>
      </div>

      <form id="authForm" novalidate>
        <div class="field">
          <label for="email">Email</label>
          <div class="input">
            <input id="email" type="email" placeholder="you@example.com" required />
          </div>
        </div>

        <div class="field">
          <label for="password">Password</label>
          <div class="input">
            <input id="password" type="password" placeholder="Enter a password" required minlength="6" />
            <button type="button" class="icon-btn" id="togglePassword" aria-label="Show password">üëÅ</button>
          </div>
        </div>

        <div class="row">
          <label class="check">
            <input type="checkbox" id="rememberMe" />
            Remember me
          </label>
          <a class="link" href="#" id="forgotLink">Forgot password?</a>
        </div>

        <button class="btn" type="submit" id="submitBtn">Sign in</button>

        <div id="msg" class="message"></div>

        <div class="footer">
          <span id="footerText">Don‚Äôt have an account?</span>
          <a class="link" href="#" id="footerAction">Create one</a>
        </div>
      </form>
    </div>
  </div>

  <script>
    const form = document.getElementById("authForm");
    const msg = document.getElementById("msg");

    const tabLogin = document.getElementById("tabLogin");
    const tabSignup = document.getElementById("tabSignup");

    const title = document.getElementById("title");
    const subtitle = document.getElementById("subtitle");
    const submitBtn = document.getElementById("submitBtn");
    const footerText = document.getElementById("footerText");
    const footerAction = document.getElementById("footerAction");
    const forgotLink = document.getElementById("forgotLink");

    const toggle = document.getElementById("togglePassword");
    const password = document.getElementById("password");

    let mode = "login"; // login | signup

    function getUsers(){
      try { return JSON.parse(localStorage.getItem("demo_users")) || {}; }
      catch { return {}; }
    }
    function setUsers(users){
      localStorage.setItem("demo_users", JSON.stringify(users));
    }
    function setSession(email, remember){
      localStorage.setItem("demo_session", JSON.stringify({email, remember: !!remember, ts: Date.now()}));
    }
    function getSession(){
      try { return JSON.parse(localStorage.getItem("demo_session")); }
      catch { return null; }
    }

    function showMessage(type, text){
      msg.className = "message " + type;
      msg.textContent = text;
      msg.style.display = "block";
    }
    function hideMessage(){
      msg.style.display = "none";
      msg.textContent = "";
      msg.className = "message";
    }

    function setMode(next){
      mode = next;
      hideMessage();

      if(mode === "login"){
        tabLogin.classList.add("active");
        tabSignup.classList.remove("active");
        title.textContent = "Welcome back";
        subtitle.textContent = "Login to continue.";
        submitBtn.textContent = "Sign in";
        footerText.textContent = "Don‚Äôt have an account?";
        footerAction.textContent = "Create one";
        forgotLink.style.display = "inline";
      } else {
        tabSignup.classList.add("active");
        tabLogin.classList.remove("active");
        title.textContent = "Create an account";
        subtitle.textContent = "Signup to get started.";
        submitBtn.textContent = "Create account";
        footerText.textContent = "Already have an account?";
        footerAction.textContent = "Sign in";
        forgotLink.style.display = "none";
      }
    }

    function isValidEmail(email){
      return typeof email === "string" && email.includes("@") && email.includes(".");
    }

    function goToDashboard(){
      window.location.href = "dashboard.html";
    }

    toggle.addEventListener("click", () => {
      const hidden = password.type === "password";
      password.type = hidden ? "text" : "password";
      toggle.textContent = hidden ? "üôà" : "üëÅ";
    });

    tabLogin.addEventListener("click", () => setMode("login"));
    tabSignup.addEventListener("click", () => setMode("signup"));
    footerAction.addEventListener("click", (e) => {
      e.preventDefault();
      setMode(mode === "login" ? "signup" : "login");
    });

    forgotLink.addEventListener("click", (e) => {
      e.preventDefault();
      showMessage("error", "Password reset is not enabled in demo mode.");
    });

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      hideMessage();

      const email = document.getElementById("email").value.trim().toLowerCase();
      const pass = document.getElementById("password").value.trim();
      const remember = document.getElementById("rememberMe").checked;

      if(!isValidEmail(email)){
        showMessage("error", "Please enter a valid email address.");
        return;
      }
      if(pass.length < 6){
        showMessage("error", "Password must be at least 6 characters.");
        return;
      }

      const users = getUsers();

      if(mode === "signup"){
        if(users[email]){
          showMessage("error", "This email is already registered. Try logging in.");
          setMode("login");
          return;
        }
        users[email] = pass;
        setUsers(users);
        setSession(email, remember);
        showMessage("success", "Account created. Redirecting...");
        setTimeout(goToDashboard, 650);
        return;
      }

      if(!users[email]){
        showMessage("error", "No account found. Please sign up first.");
        setMode("signup");
        return;
      }
      if(users[email] !== pass){
        showMessage("error", "Incorrect password. Try again.");
        return;
      }

      setSession(email, remember);
      showMessage("success", "Login successful. Redirecting...");
      setTimeout(goToDashboard, 650);
    });

    // Auto redirect if already logged in
    const session = getSession();
    if(session && session.email){
      goToDashboard();
    } else {
      setMode("login");
    }
  </script>
</body>
</html>
